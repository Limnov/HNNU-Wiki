# YOLO 模型训练

## 基本训练

```python
from ultralytics import YOLO

# 加载预训练模型
model = YOLO('yolo11s.pt')

# 开始训练
model.train(
    data='data.yaml',
    epochs=100,
    imgsz=640,
    batch=16,
    device='0'
)
```

## 常用参数

| 参数 | 说明 | 建议值 |
|------|------|--------|
| epochs | 训练轮数 | 50-300 |
| imgsz | 图像大小 | 640 |
| batch | 批次大小 | 根据显存调整 |
| lr0 | 学习率 | 0.01 |
| device | 设备 | '0' 或 'cpu' |
| patience | 早停轮数 | 20 |
| optimizer | 优化器 | 'auto' / 'MuSGD'(YOLO26) |

## 训练输出

训练结果保存在 `runs/train/exp/`：

- `weights/best.pt` - 最佳模型
- `weights/last.pt` - 最后一轮模型
- `results.png` - 训练曲线
- `confusion_matrix.png` - 混淆矩阵

## 模型验证

```python
model = YOLO('runs/train/exp/weights/best.pt')
metrics = model.val()

print(f"mAP50: {metrics.box.map50:.4f}")
print(f"mAP50-95: {metrics.box.map:.4f}")
```

## 继续训练

```python
# 从上次中断的地方继续
model = YOLO('runs/train/exp/weights/last.pt')
model.train(resume=True)
```

## 显存不足？

```python
# 减小 batch size
model.train(batch=8)

# 使用更小的模型
model = YOLO('yolo11n.pt')

# 减小输入图像
model.train(imgsz=416)
```

## YOLO26 训练

```python
from ultralytics import YOLO

model = YOLO('yolo26s.pt')

# YOLO26 默认端到端模式（无NMS）
model.train(
    data='data.yaml',
    epochs=100,
    optimizer='MuSGD'  # 新优化器
)
```

## 多 GPU 训练

```python
model.train(
    data='data.yaml',
    device=[0, 1, 2, 3]  # 使用4个GPU
)
```

## 训练技巧

1. **数据增强**：YOLO 内置 Mosaic、MixUp 等
2. **迁移学习**：从预训练模型开始
3. **学习率调度**：使用余弦退火
4. **早停**：防止过拟合
